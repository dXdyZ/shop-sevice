{
  "settings": {
    "analysis": {
      "filter": {
        "ru_stop": { "type": "stop", "stopwords": "_russian_" },
        "ru_stemmer": { "type": "stemmer", "language": "russian" },
        "en_stemmer": { "type": "stemmer", "language": "english" },
        "edge_2_20": { "type": "edge_ngram", "min_gram": 2, "max_gram": 20 }
      },
      "analyzer": {
        "fulltext_ru_en": {
          "type": "custom",
          "tokenizer": "standard",
          "filter": [
            "lowercase",
            "ru_stop",
            "ru_stemmer",
            "en_stemmer"
          ],
          "char_filter": ["html_strip"]
        },
        "edge_name": {
          "type": "custom",
          "tokenizer": "standard",
          "filter": ["lowercase", "edge_2_20"]
        },
        "keyword_casefold": {
          "type": "custom",
          "tokenizer": "keyword",
          "filter": ["lowercase","asciifolding"]
        }
      },
      "normalizer": {
        "slug_norm": {
          "type": "custom",
          "filter": ["lowercase","asciifolding"]
        }
      }
    }
  },
  "mappings": {
    "dynamic": "false",
    "properties": {
      "id": { "type": "long" },
      "public_id": { "type": "keyword" },
      "sku": { "type": "keyword" },
      "slug": { "type": "keyword", "normalizer": "slug_norm" },

      "name": {
        "type": "text",
        "analyzer": "fulltext_ru_en",
        "search_analyzer": "fulltext_ru_en",
        "fields": {
          "raw": { "type": "keyword" },
          "edge": { "type": "text", "analyzer": "edge_name", "search_analyzer": "fulltext_ru_en" }
        }
      },

      "description": {
        "type": "text",
        "analyzer": "fulltext_ru_en",
        "search_analyzer": "fulltext_ru_en"
      },
      "long_description": {
        "type": "text",
        "analyzer": "fulltext_ru_en",
        "search_analyzer": "fulltext_ru_en"
      },

      "brand": {
        "properties": {
          "id": { "type": "long" },
          "public_id": { "type": "keyword" },
          "name": {
            "type": "text",
            "analyzer": "fulltext_ru_en",
            "fields": {
              "raw": { "type": "keyword" },
              "edge": { "type": "text", "analyzer": "edge_name", "search_analyzer": "fulltext_ru_en" }
            }
          },
          "slug": { "type": "keyword", "normalizer": "slug_norm" },
          "is_active": { "type": "boolean" }
        }
      },

      "primary_category": {
        "properties": {
          "id": { "type": "long" },
          "public_id": { "type": "keyword" },
          "name": { "type": "text", "analyzer": "fulltext_ru_en", "fields": { "raw": { "type": "keyword" } } },
          "slug": { "type": "keyword", "normalizer": "slug_norm" },
          "path_ids": { "type": "long" },
          "path_slugs": { "type": "keyword" }
        }
      },

      "categories": {
        "type": "nested",
        "properties": {
          "id": { "type": "long" },
          "public_id": { "type": "keyword" },
          "name": { "type": "text", "analyzer": "fulltext_ru_en", "fields": { "raw": { "type": "keyword" } } },
          "slug": { "type": "keyword", "normalizer": "slug_norm" },
          "parent_id": { "type": "long" }
        }
      },

      "attributes": {
        "type": "nested",
        "properties": {
          "attribute_id": { "type": "long" },
          "attribute_public_id": { "type": "keyword" },
          "attribute_name": { "type": "text", "analyzer": "fulltext_ru_en", "fields": { "raw": { "type": "keyword" } } },
          "attribute_slug": { "type": "keyword", "normalizer": "slug_norm" },
          "value_id": { "type": "long" },
          "value_public_id": { "type": "keyword" },
          "value": {
            "type": "text",
            "analyzer": "fulltext_ru_en",
            "fields": {
              "raw": { "type": "keyword" }
            }
          },
          "value_slug": { "type": "keyword", "normalizer": "slug_norm" },
          "filterable": { "type": "boolean" },
          "is_active": { "type": "boolean" }
        }
      },

      "custom_attributes": {
        "type": "nested",
        "properties": {
          "name": { "type": "keyword", "normalizer": "slug_norm" },
          "value": { "type": "keyword" }
        }
      },

      "base_price": { "type": "scaled_float", "scaling_factor": 100 },
      "currency": { "type": "keyword" },

      "rating_count": { "type": "integer" },
      "is_active": { "type": "boolean" },
      "is_available": { "type": "boolean" },

      "inventory": {
        "properties": {
          "quantity": { "type": "integer" },
          "in_stock": { "type": "boolean" },
          "low_stock": { "type": "boolean" }
        }
      },

      "dimensions": {
        "properties": {
          "weight_kg": { "type": "float" },
          "length_cm": { "type": "float" },
          "width_cm": { "type": "float" },
          "height_cm": { "type": "float" }
        }
      },

      "created_at": { "type": "date" },

      "suggest": {
        "properties": {
          "name": { "type": "completion", "analyzer": "edge_name", "search_analyzer": "fulltext_ru_en" },
          "brand": { "type": "completion", "analyzer": "edge_name", "search_analyzer": "fulltext_ru_en" }
        }
      },

      "search_text": {
        "type": "text",
        "analyzer": "fulltext_ru_en",
        "search_analyzer": "fulltext_ru_en"
      }
    }
  }
}